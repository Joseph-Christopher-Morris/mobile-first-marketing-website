{
  "timestamp": "2025-10-05T22:05:33.893Z",
  "testSuite": "Comprehensive Perfect Forward Secrecy Validation",
  "version": "1.0.0",
  "results": {
    "productionDomains": {
      "timestamp": "2025-10-05T22:05:33.906Z",
      "validationResults": {},
      "overallStatus": "PASS",
      "recommendations": [],
      "domainResults": {
        "github.com": {
          "status": "PASS",
          "securityLevel": "GOOD",
          "details": {
            "timestamp": "2025-10-05T22:05:33.915Z",
            "testResults": {
              "ecdheSupport": {
                "supportedCiphers": [
                  {
                    "cipher": "ECDHE-RSA-AES256-GCM-SHA384",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-GCM-SHA256",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA384",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA256",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  }
                ],
                "unsupportedCiphers": [
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA",
                    "error": "write EPROTO 38A40000:error:0A000410:SSL routines:ssl3_read_bytes:sslv3 alert handshake failure:c:\\ws\\deps\\openssl\\openssl\\ssl\\record\\rec_layer_s3.c:1590:SSL alert number 40\n"
                  }
                ],
                "testPassed": true,
                "details": {}
              },
              "dheSupport": {
                "supportedCiphers": [],
                "unsupportedCiphers": [
                  {
                    "cipher": "DHE-RSA-AES256-GCM-SHA384",
                    "error": "write EPROTO 38A40000:error:0A000410:SSL routines:ssl3_read_bytes:sslv3 alert handshake failure:c:\\ws\\deps\\openssl\\openssl\\ssl\\record\\rec_layer_s3.c:1590:SSL alert number 40\n"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-GCM-SHA256",
                    "error": "write EPROTO 38A40000:error:0A000410:SSL routines:ssl3_read_bytes:sslv3 alert handshake failure:c:\\ws\\deps\\openssl\\openssl\\ssl\\record\\rec_layer_s3.c:1590:SSL alert number 40\n"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA256",
                    "error": "write EPROTO 38A40000:error:0A000410:SSL routines:ssl3_read_bytes:sslv3 alert handshake failure:c:\\ws\\deps\\openssl\\openssl\\ssl\\record\\rec_layer_s3.c:1590:SSL alert number 40\n"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA256",
                    "error": "write EPROTO 38A40000:error:0A000410:SSL routines:ssl3_read_bytes:sslv3 alert handshake failure:c:\\ws\\deps\\openssl\\openssl\\ssl\\record\\rec_layer_s3.c:1590:SSL alert number 40\n"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA",
                    "error": "write EPROTO 38A40000:error:0A000410:SSL routines:ssl3_read_bytes:sslv3 alert handshake failure:c:\\ws\\deps\\openssl\\openssl\\ssl\\record\\rec_layer_s3.c:1590:SSL alert number 40\n"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA",
                    "error": "write EPROTO 38A40000:error:0A000410:SSL routines:ssl3_read_bytes:sslv3 alert handshake failure:c:\\ws\\deps\\openssl\\openssl\\ssl\\record\\rec_layer_s3.c:1590:SSL alert number 40\n"
                  }
                ],
                "testPassed": false,
                "details": {}
              },
              "ephemeralKeyGeneration": {
                "connections": [
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  }
                ],
                "uniqueKeys": {},
                "ephemeralKeySupport": true,
                "testPassed": true
              },
              "pfsCompliance": {
                "pfsEnabledConnections": 3,
                "totalConnections": 4,
                "nonPfsDetected": [
                  {
                    "cipher": "TLS_AES_128_GCM_SHA256",
                    "keyExchange": "RSA"
                  }
                ],
                "compliancePercentage": 75,
                "testPassed": false
              }
            },
            "summary": {
              "totalTests": 4,
              "passed": 2,
              "failed": 2,
              "warnings": 0
            },
            "pfsCompliance": {
              "ecdheCipherSupport": true,
              "dheCipherSupport": false,
              "ephemeralKeyGeneration": true,
              "overallCompliance": true
            },
            "recommendations": [
              {
                "priority": "MEDIUM",
                "category": "Key Exchange",
                "issue": "DHE cipher suites not supported",
                "recommendation": "Consider enabling DHE cipher suites as fallback for ECDHE"
              }
            ],
            "securityLevel": "GOOD"
          },
          "timestamp": "2025-10-05T22:05:35.302Z"
        },
        "cloudfront.amazonaws.com": {
          "status": "PASS",
          "securityLevel": "GOOD",
          "details": {
            "timestamp": "2025-10-05T22:05:35.302Z",
            "testResults": {
              "ecdheSupport": {
                "supportedCiphers": [
                  {
                    "cipher": "ECDHE-RSA-AES256-GCM-SHA384",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "prime256v1",
                      "size": 256
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-GCM-SHA256",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "prime256v1",
                      "size": 256
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA384",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "prime256v1",
                      "size": 256
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA256",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "prime256v1",
                      "size": 256
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "prime256v1",
                      "size": 256
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "prime256v1",
                      "size": 256
                    }
                  }
                ],
                "unsupportedCiphers": [],
                "testPassed": true,
                "details": {}
              },
              "dheSupport": {
                "supportedCiphers": [],
                "unsupportedCiphers": [
                  {
                    "cipher": "DHE-RSA-AES256-GCM-SHA384",
                    "error": "read ECONNRESET"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-GCM-SHA256",
                    "error": "read ECONNRESET"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA256",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA256",
                    "error": "read ECONNRESET"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA",
                    "error": "read ECONNRESET"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA",
                    "error": "read ECONNRESET"
                  }
                ],
                "testPassed": false,
                "details": {}
              },
              "ephemeralKeyGeneration": {
                "connections": [
                  {
                    "keyType": "ECDH",
                    "keySize": 256,
                    "keyName": "prime256v1"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 256,
                    "keyName": "prime256v1"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 256,
                    "keyName": "prime256v1"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 256,
                    "keyName": "prime256v1"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 256,
                    "keyName": "prime256v1"
                  }
                ],
                "uniqueKeys": {},
                "ephemeralKeySupport": true,
                "testPassed": true
              },
              "pfsCompliance": {
                "pfsEnabledConnections": 3,
                "totalConnections": 4,
                "nonPfsDetected": [
                  {
                    "cipher": "TLS_AES_128_GCM_SHA256",
                    "keyExchange": "RSA"
                  }
                ],
                "compliancePercentage": 75,
                "testPassed": false
              }
            },
            "summary": {
              "totalTests": 4,
              "passed": 2,
              "failed": 2,
              "warnings": 0
            },
            "pfsCompliance": {
              "ecdheCipherSupport": true,
              "dheCipherSupport": false,
              "ephemeralKeyGeneration": true,
              "overallCompliance": true
            },
            "recommendations": [
              {
                "priority": "MEDIUM",
                "category": "Key Exchange",
                "issue": "DHE cipher suites not supported",
                "recommendation": "Consider enabling DHE cipher suites as fallback for ECDHE"
              }
            ],
            "securityLevel": "GOOD"
          },
          "timestamp": "2025-10-05T22:05:40.546Z"
        },
        "aws.amazon.com": {
          "status": "PASS",
          "securityLevel": "GOOD",
          "details": {
            "timestamp": "2025-10-05T22:05:40.546Z",
            "testResults": {
              "ecdheSupport": {
                "supportedCiphers": [
                  {
                    "cipher": "ECDHE-RSA-AES256-GCM-SHA384",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-GCM-SHA256",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA384",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA256",
                    "keyExchange": "ECDHE",
                    "ephemeralKey": {
                      "type": "ECDH",
                      "name": "X25519",
                      "size": 253
                    }
                  }
                ],
                "unsupportedCiphers": [
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  }
                ],
                "testPassed": true,
                "details": {}
              },
              "dheSupport": {
                "supportedCiphers": [],
                "unsupportedCiphers": [
                  {
                    "cipher": "DHE-RSA-AES256-GCM-SHA384",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-GCM-SHA256",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA256",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA256",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA",
                    "error": "Client network socket disconnected before secure TLS connection was established"
                  }
                ],
                "testPassed": false,
                "details": {}
              },
              "ephemeralKeyGeneration": {
                "connections": [
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  },
                  {
                    "keyType": "ECDH",
                    "keySize": 253,
                    "keyName": "X25519"
                  }
                ],
                "uniqueKeys": {},
                "ephemeralKeySupport": true,
                "testPassed": true
              },
              "pfsCompliance": {
                "pfsEnabledConnections": 3,
                "totalConnections": 4,
                "nonPfsDetected": [
                  {
                    "cipher": "TLS_AES_128_GCM_SHA256",
                    "keyExchange": "RSA"
                  }
                ],
                "compliancePercentage": 75,
                "testPassed": false
              }
            },
            "summary": {
              "totalTests": 4,
              "passed": 2,
              "failed": 2,
              "warnings": 0
            },
            "pfsCompliance": {
              "ecdheCipherSupport": true,
              "dheCipherSupport": false,
              "ephemeralKeyGeneration": true,
              "overallCompliance": true
            },
            "recommendations": [
              {
                "priority": "MEDIUM",
                "category": "Key Exchange",
                "issue": "DHE cipher suites not supported",
                "recommendation": "Consider enabling DHE cipher suites as fallback for ECDHE"
              }
            ],
            "securityLevel": "GOOD"
          },
          "timestamp": "2025-10-05T22:05:42.486Z"
        }
      },
      "cloudFrontResults": null,
      "summary": {
        "totalDomains": 3,
        "passedDomains": 3,
        "failedDomains": 0,
        "errorDomains": 0
      }
    },
    "cloudFrontPFS": {
      "timestamp": "2025-10-05T22:05:42.500Z",
      "validationResults": {},
      "overallStatus": "FAIL",
      "recommendations": [
        {
          "priority": "HIGH",
          "category": "PFS Compliance",
          "issue": "1 domains failed PFS validation",
          "recommendation": "Review and update TLS configuration to support Perfect Forward Secrecy"
        }
      ],
      "domainResults": {
        "invalid-domain-that-does-not-exist.com": {
          "status": "FAIL",
          "securityLevel": "POOR",
          "details": {
            "timestamp": "2025-10-05T22:05:42.504Z",
            "testResults": {
              "ecdheSupport": {
                "supportedCiphers": [],
                "unsupportedCiphers": [
                  {
                    "cipher": "ECDHE-RSA-AES256-GCM-SHA384",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-GCM-SHA256",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA384",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA256",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "ECDHE-RSA-AES256-SHA",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "ECDHE-RSA-AES128-SHA",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  }
                ],
                "testPassed": false,
                "details": {}
              },
              "dheSupport": {
                "supportedCiphers": [],
                "unsupportedCiphers": [
                  {
                    "cipher": "DHE-RSA-AES256-GCM-SHA384",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-GCM-SHA256",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA256",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA256",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "DHE-RSA-AES256-SHA",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  },
                  {
                    "cipher": "DHE-RSA-AES128-SHA",
                    "error": "getaddrinfo ENOTFOUND invalid-domain-that-does-not-exist.com"
                  }
                ],
                "testPassed": false,
                "details": {}
              },
              "ephemeralKeyGeneration": {
                "connections": [],
                "uniqueKeys": {},
                "ephemeralKeySupport": false,
                "testPassed": false
              },
              "pfsCompliance": {
                "pfsEnabledConnections": 0,
                "totalConnections": 0,
                "nonPfsDetected": [],
                "compliancePercentage": 0,
                "testPassed": false
              }
            },
            "summary": {
              "totalTests": 4,
              "passed": 0,
              "failed": 4,
              "warnings": 0
            },
            "pfsCompliance": {
              "ecdheCipherSupport": false,
              "dheCipherSupport": false,
              "ephemeralKeyGeneration": false,
              "overallCompliance": false
            },
            "recommendations": [
              {
                "priority": "HIGH",
                "category": "Key Exchange",
                "issue": "ECDHE cipher suites not supported",
                "recommendation": "Enable ECDHE cipher suites in CloudFront distribution for better PFS support"
              },
              {
                "priority": "MEDIUM",
                "category": "Key Exchange",
                "issue": "DHE cipher suites not supported",
                "recommendation": "Consider enabling DHE cipher suites as fallback for ECDHE"
              },
              {
                "priority": "HIGH",
                "category": "Key Generation",
                "issue": "Ephemeral key generation not working properly",
                "recommendation": "Verify CloudFront configuration supports ephemeral key generation"
              }
            ],
            "securityLevel": "POOR"
          },
          "timestamp": "2025-10-05T22:05:42.620Z"
        }
      },
      "cloudFrontResults": null,
      "summary": {
        "totalDomains": 1,
        "passedDomains": 0,
        "failedDomains": 1,
        "errorDomains": 0
      }
    },
    "cipherSuitePreferences": {
      "preferredCiphers": [
        "ECDHE-RSA-AES256-GCM-SHA384",
        "ECDHE-RSA-AES128-GCM-SHA256"
      ],
      "supportedCiphers": [
        "ECDHE-RSA-AES256-GCM-SHA384",
        "ECDHE-RSA-AES128-GCM-SHA256",
        "DHE-RSA-AES256-GCM-SHA384",
        "DHE-RSA-AES128-GCM-SHA256"
      ],
      "weakCiphers": [],
      "testPassed": true
    },
    "ephemeralKeyRotation": {
      "keyRotationDetected": true,
      "uniqueKeys": 3,
      "testConnections": 5,
      "testPassed": true
    },
    "tlsVersionPFS": {
      "tlsVersions": {
        "TLSv1.2": {
          "pfsSupported": true,
          "cipherCount": 4
        },
        "TLSv1.3": {
          "pfsSupported": true,
          "cipherCount": 2
        }
      },
      "overallCompliance": true,
      "testPassed": true
    }
  },
  "summary": {
    "totalTests": 5,
    "passedTests": 4,
    "failedTests": 1,
    "warnings": 0
  },
  "compliance": {
    "pfsCompliant": true,
    "securityLevel": "GOOD",
    "recommendations": [
      {
        "priority": "HIGH",
        "category": "CloudFront Security",
        "issue": "CloudFront distribution PFS configuration needs improvement",
        "recommendation": "Update CloudFront security policy to enforce PFS-enabled cipher suites"
      }
    ]
  }
}